Marionette.HighCharts={views:{},models:{}},function(){var a=(Marionette.HighCharts.models,Marionette.HighCharts.models.Serie=Backbone.Model.extend({constructor:function(a){Backbone.Model.prototype.constructor.apply(this,arguments),this.highChartsId=(a||{}).highChartsId||parseInt(_.uniqueId())},toHighChartsData:function(){return $.extend(!0,{},this.toJSON(),{id:this.highChartsId})},addPoint:function(a){this.set("data",this.get("data").concat([a]),{silent:!0}),this.trigger("add:point",this,a)}}));Marionette.HighCharts.models.SerieCollection=Backbone.Collection.extend({model:a,toHighChartsData:function(){return this.map(function(a){return a.toHighChartsData()})}})}(),Marionette.HighCharts.models.HighChartsOptions=Backbone.Model.extend({}),Marionette.HighCharts.views.Chart=Marionette.ItemView.extend({template:!1,initialize:function(){this.bindHighChartsEvents(),this.initializeHighCharts()},initializeHighCharts:function(){this.$el.highcharts($.extend(!0,{series:this.collection.toHighChartsData(),chart:{events:this.getHighChartsEvents()}},this.model.toJSON()))},onRender:function(){this.$el.highCharts().redraw()},bindHighChartsEvents:function(){this.listenTo(this.collection,"add",this.onAddSerie),this.listenTo(this.collection,"remove",this.onRemoveSerie),this.listenTo(this.collection,"reset",this.render),this.collection.each(this.bindHighChartsSerieEvents,this)},bindHighChartsSerieEvents:function(a){this.listenTo(a,"change",this.onSerieChange),this.listenTo(a,"add:point",this.onSerieAddPoint)},unbindHighChartsSerieEvents:function(a){this.stopListening(a)},onSerieAddPoint:function(a,b){var c=_.find(this.$el.highcharts().series,function(b){return b.options.id===a.highChartsId});c.addPoint(b)},onSerieChange:function(a){var b=a.changed,c=_.keys(b).length,d=_.find(this.$el.highcharts().series,function(b){return b.options.id===a.highChartsId});1===c&&b.data?d.setData(a.get("data")):1===c&&b.visible?d.setVisible(a.get("visible")):2===c&&b.visible&&b.data?(d.setData(a.get("data")),d.setVisible(a.get("visible"))):d.update(b)},onAddSerie:function(a){this.$el.highcharts().addSeries(a.toJSON(),{id:a.id||a.cid}),this.bindHighChartsSerieEvents(a)},onRemoveSerie:function(a){_.find(this.$el.highcharts().series,function(b){return b.options.id===a.highChartsId}).remove(),this.unbindHighChartsSerieEvents(a)},onBeforeDestroy:function(){this.$el.highcharts().destroy()},highChartsEvents:{},getHighChartsEvents:function(){return _.reduce(this.highChartsEvents,function(a,b,c){return a[c]=_.bind(this[b],this),a},{},this)}});